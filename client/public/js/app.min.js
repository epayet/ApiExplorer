"use strict";var APP_NAME="apiExplorer",APP_NAME_CONTROLLERS=APP_NAME+".controllers",APP_NAME_SERVICES=APP_NAME+".services",APP_NAME_FILTERS=APP_NAME+".filters",APP_NAME_DIRECTIVES=APP_NAME+".directives";angular.module(APP_NAME,["ngRoute","ngResource","ui.bootstrap",APP_NAME_FILTERS,APP_NAME_SERVICES,APP_NAME_DIRECTIVES,APP_NAME_CONTROLLERS]).config(["$routeProvider",function(e){e.when("/explorer",{templateUrl:"partials/explorer.html",controller:"ExplorerController"}),e.otherwise({redirectTo:"/explorer"})}]),angular.module(APP_NAME_CONTROLLERS,[]),angular.module(APP_NAME_SERVICES,[]),angular.module(APP_NAME_FILTERS,[]),angular.module(APP_NAME_DIRECTIVES,[]),angular.module(APP_NAME_CONTROLLERS).controller("ExplorerController",["$scope","ApiInfo","Resources","WaitingService","AlertService","ExplorerService",function(e,r,t,o,a,n){function l(r){for(var t=0;t<r.length;t++){e.isResourceCollapsed[t]=!0,e.isMethodCollapsed[t]=[];for(var o=r[t].methods,a=0;a<o.length;a++)e.isMethodCollapsed[t][a]=!0,u(o[a].parameters)}}function u(e){if(e)for(var r=0;r<e.length;r++)"enum"==e[r].type&&e[r].required&&(e[r].value=e[r].values[0])}var s=new o;new a(e.$parent);e.isResourceCollapsed=[],e.isMethodCollapsed=[],e.apiInfo=r.get(),e.resources=t.query(l),e.callMethod=function(r){var t={apiInfo:e.apiInfo,method:r};s.start(),n.execute(t,function(r){e.result=r,s.stop()}),e.lastMethod=r},e.getLabelForMethod=function(e){var r={get:"info",post:"success","delete":"danger",put:"warning"};return r[e]},e.hasExampleValue=function(e){return n.hasExampleValue(e)},e.useExampleValues=function(e){n.replaceExampleValues(e)}}]),angular.module(APP_NAME_CONTROLLERS).controller("IndexController",["$scope","$location",function(e,r){e.isActive=function(e){return e===r.path()}}]),angular.module(APP_NAME_SERVICES).factory("ExplorerService",["$http","$location",function(e,r){function t(e,r){function t(e,r,t,o){var a="&";return 0===o&&(a="?"),e+a+r+"="+t}var o=0;if(e)for(var a=0;a<e.length;a++)void 0!==e[a].value&&("query"==e[a].parameterType?(r=t(r,e[a].name,e[a].value,o),o++):"id"==e[a].parameterType&&(r=r.replace("{"+e[a].name+"}",e[a].value)));return r}return{hasExampleValue:function(e){if(!e)return!1;for(var r=0;r<e.length;r++)if(e[r].exampleValue)return!0;return!1},replaceExampleValues:function(e){if(e)for(var r=0;r<e.length;r++)"object"==e[r].type?e[r].stringValue=angular.toJson(e[r].exampleValue):e[r].value=e[r].exampleValue},execute:function(r,o){function a(e,r,t,a){o({url:l,result:e.data?e.data:e,body:u})}function n(){var e=void 0,t=r.method.parameters;if(t)for(var o=0;o<t.length;o++)"body"==t[o].parameterType&&void 0!==t[o].value&&(void 0===e&&(e={}),e[t[o].name]=t[o].value);return e}var l=r.apiInfo.url+r.method.path;l=t(r.method.parameters,l);var u=n(),s=e[r.method.verb];switch(r.method.verb){case"get":s(l).success(a).error(a);break;case"post":s(l,u).success(a).error(a);break;case"put":s(l,u).success(a).error(a);break;case"delete":s(l).success(a).error(a)}},getApiUrl:function(){return r.absUrl().split("#")[0]+"api/"}}}]),angular.module(APP_NAME_SERVICES).factory("ApiInfo",["ResourceFactory","ExplorerService",function(e,r){var t={name:"apiInfo",apiUrl:r.getApiUrl()};return e.createResource(t)}]),angular.module(APP_NAME_SERVICES).factory("Resources",["ResourceFactory","ExplorerService",function(e,r){var t={name:"resources",idField:"name",apiUrl:r.getApiUrl()};return e.createResource(t)}]),angular.module(APP_NAME_SERVICES).factory("AlertService",["$timeout",function(e){var r=function(e,r){this.scope=e,this.scopeCloseDelay=r?r:8e3,this.initializeScope()};return r.prototype.add=function(r,t){var o=this.scope;t||(t="danger"),o.alerts.push({type:t,message:r}),e(function(){o.closeAlert(o.alerts.length-1)},this.scopeCloseDelay)},r.prototype.initializeScope=function(){var e=this.scope;null==e.alerts&&(e.alerts=[]),null==e.closeAlert&&(e.closeAlert=function(r){e.alerts.splice(r,1)})},r}]),angular.module(APP_NAME_SERVICES).factory("ResourceFactory",["$resource",function(e){return{createResource:function(r){var t=r.idField,o=r.apiUrl+r.name+"/:"+t,a={};a[t]="@"+t;var n=e(o,{},{update:{method:"PUT",params:a}});return n.getFromAvailable=function(e,r){if(null==e)return null;for(var o=0;o<e.length;o++)if(null!=e[o]&&e[o][t]==r)return e[o]},n}}}]),angular.module(APP_NAME_SERVICES).factory("util",[function(){var e=function(r){switch(typeof r){default:return r;case"object":if(Array.isArray(r))return r.slice(0);var t={};for(var o in r)t[o]=e(r[o]);return t}};return{escapeStr:function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""},copy:e,guessType:function(e){var r=e.substr(0,1);switch(r){case"[":case"{":return"json";case"<":return"xml"}}}}]),angular.module(APP_NAME_SERVICES).factory("WaitingService",["$modal",function(e){var r=function(){};return r.prototype.start=function(r){var t=this;r||(r="Processing"),this.modalInstance=e.open({templateUrl:"templates/modal-waiting.html",controller:function(e){t.scope=e,e.message=r,e.closeModal=function(){e.$close()}}})},r.prototype.setMessage=function(e){this.scope&&(this.scope.message=e)},r.prototype.stop=function(){var e=this;try{this.modalInstance.close()}catch(r){setTimeout(function(){e.modalInstance.close()},1e3)}finally{this.scope=null}},r}]);